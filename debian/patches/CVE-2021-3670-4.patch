From 2b3af3b560c9617a233c131376c870fce146c002 Mon Sep 17 00:00:00 2001
From: Andrew Bartlett <abartlet@samba.org>
Date: Thu, 18 Nov 2021 15:27:08 +1300
Subject: [PATCH] CVE-2021-3670 ldap_server: Remove duplicate print of LDAP
 search details

BUG: https://bugzilla.samba.org/show_bug.cgi?id=14694

Signed-off-by: Andrew Bartlett <abartlet@samba.org>
Reviewed-by: Douglas Bagnall <douglas.bagnall@catalyst.net.nz>
---
 source4/ldap_server/ldap_backend.c | 3 ---
 1 file changed, 3 deletions(-)

--- a/source4/ldap_server/ldap_backend.c
+++ b/source4/ldap_server/ldap_backend.c
@@ -732,9 +732,6 @@ static NTSTATUS ldapsrv_SearchRequest(st
 	unsigned int i;
 	int extended_type = 1;
 
-	DEBUG(10, ("SearchRequest"));
-	DEBUGADD(10, (" basedn: %s", req->basedn));
-	DEBUGADD(10, (" filter: %s\n", ldb_filter_from_tree(call, req->tree)));
 
 	local_ctx = talloc_new(call);
 	NT_STATUS_HAVE_NO_MEMORY(local_ctx);
