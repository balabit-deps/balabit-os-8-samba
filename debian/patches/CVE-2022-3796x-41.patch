From 716149ed2bcc2e67eb598cbb5f77e6240f8d155e Mon Sep 17 00:00:00 2001
From: Stefan Metzmacher <metze@samba.org>
Date: Wed, 23 Nov 2022 15:20:40 +0100
Subject: [PATCH] CVE-2022-37966 s3:net_ads: no longer reference des encryption
 types

We no longer have support for des encryption types in the kerberos
libraries anyway.

BUG: https://bugzilla.samba.org/show_bug.cgi?id=15237

Signed-off-by: Stefan Metzmacher <metze@samba.org>
Reviewed-by: Joseph Sutton <josephsutton@catalyst.net.nz>
Reviewed-by: Andrew Bartlett <abartlet@samba.org>
(cherry picked from commit 4cedaa643bf95ef2628f1b631feda833bb2e7da1)
---
 source3/utils/net_ads.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

--- a/source3/utils/net_ads.c
+++ b/source3/utils/net_ads.c
@@ -3715,7 +3715,8 @@ static int net_ads_enctypes_set(struct n
 		goto done;
 	}
 
-	etype_list = ENC_CRC32 | ENC_RSA_MD5 | ENC_RC4_HMAC_MD5;
+	etype_list = 0;
+	etype_list |= ENC_RC4_HMAC_MD5;
 	etype_list |= ENC_HMAC_SHA1_96_AES128;
 	etype_list |= ENC_HMAC_SHA1_96_AES256;
 
