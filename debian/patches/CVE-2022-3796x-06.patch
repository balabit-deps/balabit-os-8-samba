From 0fe0643e0b7c283a4e49ae4be772fa6a83fe978d Mon Sep 17 00:00:00 2001
From: Andreas Schneider <asn@samba.org>
Date: Thu, 27 Oct 2022 08:44:58 +0200
Subject: [PATCH] CVE-2022-37966 s3:param: Fix old-style function definition

Signed-off-by: Andreas Schneider <asn@samba.org>
Reviewed-by: Jeremy Allison <jra@samba.org>
(cherry picked from commit 80dc3bc2b80634ab7c6c71fa1f9b94f0216322b2)

BUG: https://bugzilla.samba.org/show_bug.cgi?id=15237
Signed-off-by: Stefan Metzmacher <metze@samba.org>
---
 source3/param/loadparm.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

--- a/source3/param/loadparm.c
+++ b/source3/param/loadparm.c
@@ -2118,7 +2118,7 @@ struct loadparm_service *lp_servicebynum
 	return ServicePtrs[snum];
 }
 
-struct loadparm_service *lp_default_loadparm_service()
+struct loadparm_service *lp_default_loadparm_service(void)
 {
 	return &sDefault;
 }
@@ -4759,7 +4759,7 @@ unsigned int * get_flags(void)
 	return flags_list;
 }
 
-enum samba_weak_crypto lp_weak_crypto()
+enum samba_weak_crypto lp_weak_crypto(void)
 {
 	if (Globals.weak_crypto == SAMBA_WEAK_CRYPTO_UNKNOWN) {
 		Globals.weak_crypto = SAMBA_WEAK_CRYPTO_DISALLOWED;
