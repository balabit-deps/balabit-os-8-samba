From 5f9e13ce20a0bd9f80820f1d1afedfee035ba0e2 Mon Sep 17 00:00:00 2001
From: Stefan Metzmacher <metze@samba.org>
Date: Wed, 23 Nov 2022 15:20:40 +0100
Subject: [PATCH] CVE-2022-37966 s3:libnet: no longer reference des encryption
 types

We no longer have support for des encryption types in the kerberos
libraries anyway.

BUG: https://bugzilla.samba.org/show_bug.cgi?id=15237

Signed-off-by: Stefan Metzmacher <metze@samba.org>
Reviewed-by: Joseph Sutton <josephsutton@catalyst.net.nz>
Reviewed-by: Andrew Bartlett <abartlet@samba.org>
(cherry picked from commit 40b47c194d7c41fbc6515b6029d5afafb0911232)
---
 source3/libnet/libnet_join.c | 5 ++---
 1 file changed, 2 insertions(+), 3 deletions(-)

--- a/source3/libnet/libnet_join.c
+++ b/source3/libnet/libnet_join.c
@@ -2448,9 +2448,8 @@ WERROR libnet_init_JoinCtx(TALLOC_CTX *m
 
 	ctx->in.secure_channel_type = SEC_CHAN_WKSTA;
 
-	ctx->in.desired_encryption_types = ENC_CRC32 |
-					   ENC_RSA_MD5 |
-					   ENC_RC4_HMAC_MD5;
+	ctx->in.desired_encryption_types = 0;
+	ctx->in.desired_encryption_types |= ENC_RC4_HMAC_MD5;
 	ctx->in.desired_encryption_types |= ENC_HMAC_SHA1_96_AES128;
 	ctx->in.desired_encryption_types |= ENC_HMAC_SHA1_96_AES256;
 
