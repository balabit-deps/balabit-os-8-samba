From 153e4a391420f1d492d7af3a3cfb71dabf98e08f Mon Sep 17 00:00:00 2001
From: Stefan Metzmacher <metze@samba.org>
Date: Wed, 23 Nov 2022 15:20:40 +0100
Subject: [PATCH] CVE-2022-37966 s3:libads: no longer reference des encryption
 types

We no longer have support for des encryption types in the kerberos
libraries anyway.

BUG: https://bugzilla.samba.org/show_bug.cgi?id=15237

Signed-off-by: Stefan Metzmacher <metze@samba.org>
Reviewed-by: Joseph Sutton <josephsutton@catalyst.net.nz>
Reviewed-by: Andrew Bartlett <abartlet@samba.org>
(cherry picked from commit a683507e560a499336c50b88abcd853d49618bf4)
---
 source3/libads/kerberos.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

--- a/source3/libads/kerberos.c
+++ b/source3/libads/kerberos.c
@@ -619,7 +619,7 @@ static char *get_enctypes(TALLOC_CTX *me
 
 	if (lp_kerberos_encryption_types() == KERBEROS_ETYPES_ALL ||
 	    lp_kerberos_encryption_types() == KERBEROS_ETYPES_LEGACY) {
-		legacy_enctypes = "arcfour-hmac-md5 des-cbc-crc des-cbc-md5";
+		legacy_enctypes = "arcfour-hmac-md5";
 	}
 
 	enctypes = talloc_asprintf(mem_ctx, "\tdefault_etypes = %s %s\n",
