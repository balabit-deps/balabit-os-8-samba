From d6b9e8b33978a1b85b487e8363476a3356af893d Mon Sep 17 00:00:00 2001
From: Stefan Metzmacher <metze@samba.org>
Date: Tue, 29 Nov 2022 20:59:52 +0100
Subject: [PATCH] CVE-2022-37966 python:tests/krb5: add better
 PADATA_SUPPORTED_ETYPES assert message

BUG: https://bugzilla.samba.org/show_bug.cgi?id=15237

Signed-off-by: Stefan Metzmacher <metze@samba.org>
Reviewed-by: Joseph Sutton <josephsutton@catalyst.net.nz>
Reviewed-by: Andrew Bartlett <abartlet@samba.org>
(cherry picked from commit c7c576208960e336da276e251ad7a526e1b3ed45)
---
 python/samba/tests/krb5/raw_testcase.py | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/python/samba/tests/krb5/raw_testcase.py b/python/samba/tests/krb5/raw_testcase.py
index e4b6402bb27..2f188dca3fa 100644
--- a/python/samba/tests/krb5/raw_testcase.py
+++ b/python/samba/tests/krb5/raw_testcase.py
@@ -2955,8 +2955,8 @@ class RawKerberosTest(TestCaseInTempDir):
                         self.assertEqual(
                             supported_etypes & ~ignore_bits,
                             expected_supported_etypes & ~ignore_bits,
-                            f'got: {supported_etypes}, '
-                            f'expected: {expected_supported_etypes}')
+                            f'PADATA_SUPPORTED_ETYPES: got: {supported_etypes} (0x{supported_etypes:X}), '
+                            f'expected: {expected_supported_etypes} (0x{expected_supported_etypes:X})')
 
                     if PADATA_PAC_OPTIONS in enc_pa_dict:
                         pac_options = self.der_decode(
-- 
2.34.1

