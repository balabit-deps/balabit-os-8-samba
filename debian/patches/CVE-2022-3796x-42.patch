From f644fc69971c776102f0b60fe184134a413d13e1 Mon Sep 17 00:00:00 2001
From: Stefan Metzmacher <metze@samba.org>
Date: Tue, 22 Nov 2022 09:48:45 +0100
Subject: [PATCH] CVE-2022-37966 s3:net_ads: let 'net ads enctypes list' pretty
 print AES256-SK and RESOURCE-SID-COMPRESSION-DISABLED

BUG: https://bugzilla.samba.org/show_bug.cgi?id=15237

Signed-off-by: Stefan Metzmacher <metze@samba.org>
Reviewed-by: Joseph Sutton <josephsutton@catalyst.net.nz>
Reviewed-by: Andrew Bartlett <abartlet@samba.org>
(cherry picked from commit b7260c89e0df18822fa276e681406ec4d3921caa)
---
 source3/utils/net_ads.c | 6 ++++++
 1 file changed, 6 insertions(+)

--- a/source3/utils/net_ads.c
+++ b/source3/utils/net_ads.c
@@ -3638,6 +3638,12 @@ static void net_ads_enctype_dump_enctype
 	printf("[%s] 0x%08x AES256-CTS-HMAC-SHA1-96\n",
 		enctypes & ENC_HMAC_SHA1_96_AES256 ? "X" : " ",
 		ENC_HMAC_SHA1_96_AES256);
+	printf("[%s] 0x%08x AES256-CTS-HMAC-SHA1-96-SK\n",
+		enctypes & ENC_HMAC_SHA1_96_AES256_SK ? "X" : " ",
+		ENC_HMAC_SHA1_96_AES256_SK);
+	printf("[%s] 0x%08x RESOURCE-SID-COMPRESSION-DISABLED\n",
+		enctypes & KERB_ENCTYPE_RESOURCE_SID_COMPRESSION_DISABLED ? "X" : " ",
+		KERB_ENCTYPE_RESOURCE_SID_COMPRESSION_DISABLED);
 }
 
 static int net_ads_enctypes_list(struct net_context *c, int argc, const char **argv)
