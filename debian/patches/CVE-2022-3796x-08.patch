From 4543bd706e53844f0585aaa48a574bf8fe2050de Mon Sep 17 00:00:00 2001
From: Andreas Schneider <asn@samba.org>
Date: Thu, 27 Oct 2022 08:47:32 +0200
Subject: [PATCH] CVE-2022-37966 s3:utils: Fix old-style function definition

Signed-off-by: Andreas Schneider <asn@samba.org>
Reviewed-by: Jeremy Allison <jra@samba.org>
(cherry picked from commit b787692b5e915031d4653bf375995320ed1aca07)

BUG: https://bugzilla.samba.org/show_bug.cgi?id=15237
Signed-off-by: Stefan Metzmacher <metze@samba.org>
---
 source3/utils/ntlm_auth.c | 12 ++++++------
 1 file changed, 6 insertions(+), 6 deletions(-)

--- a/source3/utils/ntlm_auth.c
+++ b/source3/utils/ntlm_auth.c
@@ -365,7 +365,7 @@ const char *get_winbind_netbios_name(voi
 
 }
 
-DATA_BLOB get_challenge(void) 
+DATA_BLOB get_challenge(void)
 {
 	static DATA_BLOB chal;
 	if (opt_challenge.length)
@@ -441,7 +441,7 @@ static bool get_require_membership_sid(v
  * need to contact trusted domain
  */
 
-int get_pam_winbind_config()
+int get_pam_winbind_config(void)
 {
 	int ctrl = 0;
 	struct tiniparser_dictionary *d = NULL;
@@ -713,7 +713,7 @@ static NTSTATUS contact_winbind_change_p
 	nt_status = (NT_STATUS(response.data.auth.nt_status));
 	if (!NT_STATUS_IS_OK(nt_status))
 	{
-		if (error_string) 
+		if (error_string)
 			*error_string = smb_xstrdup(response.data.auth.error_string);
 		winbindd_free_response(&response);
 		return nt_status;
@@ -863,7 +863,7 @@ done:
 
 
 /**
- * Return the challenge as determined by the authentication subsystem 
+ * Return the challenge as determined by the authentication subsystem
  * @return an 8 byte random challenge
  */
 
@@ -871,7 +871,7 @@ static NTSTATUS ntlm_auth_get_challenge(
 					uint8_t chal[8])
 {
 	if (auth_ctx->challenge.data.length == 8) {
-		DEBUG(5, ("auth_get_challenge: returning previous challenge by module %s (normal)\n", 
+		DEBUG(5, ("auth_get_challenge: returning previous challenge by module %s (normal)\n",
 			  auth_ctx->challenge.set_by));
 		memcpy(chal, auth_ctx->challenge.data.data, 8);
 		return NT_STATUS_OK;
@@ -1933,7 +1933,7 @@ static void manage_ntlm_server_1_request
 
 				printf("Authenticated: Yes\n");
 
-				if (ntlm_server_1_lm_session_key 
+				if (ntlm_server_1_lm_session_key
 				    && (!all_zero(lm_key,
 						  sizeof(lm_key)))) {
 					hex_lm_key = hex_encode_talloc(NULL,
