From ece27efe594372748c625b7c60c7461b9f39cd67 Mon Sep 17 00:00:00 2001
From: Stefan Metzmacher <metze@samba.org>
Date: Wed, 23 Nov 2022 15:19:48 +0100
Subject: [PATCH] CVE-2022-37966 s3:net_ads: remove unused ifdef
 HAVE_ENCTYPE_AES*

aes encryption types are always supported.

BUG: https://bugzilla.samba.org/show_bug.cgi?id=15237

Signed-off-by: Stefan Metzmacher <metze@samba.org>
Reviewed-by: Joseph Sutton <josephsutton@catalyst.net.nz>
Reviewed-by: Andrew Bartlett <abartlet@samba.org>
(cherry picked from commit f3fe1f2ce64ed36be5b001fb4fea92428e73e4e3)
---
 source3/utils/net_ads.c | 4 ----
 1 file changed, 4 deletions(-)

--- a/source3/utils/net_ads.c
+++ b/source3/utils/net_ads.c
@@ -3716,12 +3716,8 @@ static int net_ads_enctypes_set(struct n
 	}
 
 	etype_list = ENC_CRC32 | ENC_RSA_MD5 | ENC_RC4_HMAC_MD5;
-#ifdef HAVE_ENCTYPE_AES128_CTS_HMAC_SHA1_96
 	etype_list |= ENC_HMAC_SHA1_96_AES128;
-#endif
-#ifdef HAVE_ENCTYPE_AES256_CTS_HMAC_SHA1_96
 	etype_list |= ENC_HMAC_SHA1_96_AES256;
-#endif
 
 	if (argv[1] != NULL) {
 		sscanf(argv[1], "%i", &etype_list);
