From 8b8835b09fa45c0cd3aba5d5aa504fcfd290386f Mon Sep 17 00:00:00 2001
From: Stefan Metzmacher <metze@samba.org>
Date: Wed, 23 Nov 2022 15:27:14 +0100
Subject: [PATCH] CVE-2022-37966 s4:pydsdb: add ENC_HMAC_SHA1_96_AES256_SK

BUG: https://bugzilla.samba.org/show_bug.cgi?id=15237

Signed-off-by: Stefan Metzmacher <metze@samba.org>
Reviewed-by: Joseph Sutton <josephsutton@catalyst.net.nz>
Reviewed-by: Andrew Bartlett <abartlet@samba.org>
(cherry picked from commit 621b8c3927b63776146940b183b03b3ea77fd2d7)
---
 source4/dsdb/pydsdb.c | 1 +
 1 file changed, 1 insertion(+)

--- a/source4/dsdb/pydsdb.c
+++ b/source4/dsdb/pydsdb.c
@@ -1628,6 +1628,7 @@ MODULE_INIT_FUNC(dsdb)
 	ADD_DSDB_FLAG(ENC_RC4_HMAC_MD5);
 	ADD_DSDB_FLAG(ENC_HMAC_SHA1_96_AES128);
 	ADD_DSDB_FLAG(ENC_HMAC_SHA1_96_AES256);
+	ADD_DSDB_FLAG(ENC_HMAC_SHA1_96_AES256_SK);
 
 	ADD_DSDB_FLAG(SEARCH_FLAG_ATTINDEX);
 	ADD_DSDB_FLAG(SEARCH_FLAG_PDNTATTINDEX);
