From 6f94a270722594b521cbef6387b440759e2cb3ac Mon Sep 17 00:00:00 2001
From: Andreas Schneider <asn@samba.org>
Date: Thu, 27 Oct 2022 08:46:39 +0200
Subject: [PATCH] CVE-2022-37966 s3:client: Fix old-style function definition

Signed-off-by: Andreas Schneider <asn@samba.org>
Reviewed-by: Jeremy Allison <jra@samba.org>
(cherry picked from commit 81f4335dfb847c041bfd3d6110fc8f1d5741d41f)

BUG: https://bugzilla.samba.org/show_bug.cgi?id=15237
Signed-off-by: Stefan Metzmacher <metze@samba.org>
---
 source3/client/clitar.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/source3/client/clitar.c b/source3/client/clitar.c
index d62b53d2b17..a5c7df9c869 100644
--- a/source3/client/clitar.c
+++ b/source3/client/clitar.c
@@ -218,7 +218,7 @@ static NTSTATUS is_subpath(const char *sub, const char *full,
  /*
  * tar_get_ctx - retrieve global tar context handle
  */
-struct tar *tar_get_ctx()
+struct tar *tar_get_ctx(void)
 {
 	return &tar_ctx;
 }
-- 
2.34.1

