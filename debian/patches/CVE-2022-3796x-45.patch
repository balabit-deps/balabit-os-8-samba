From 0d7dc04404dee3f1ddce219f3ed1db736716eef7 Mon Sep 17 00:00:00 2001
From: Stefan Metzmacher <metze@samba.org>
Date: Thu, 3 Feb 2022 16:27:15 +0100
Subject: [PATCH] CVE-2022-37966 drsuapi.idl: add trustedDomain related ATTID
 values

For now this is only for debugging in order to see
DRSUAPI_ATTID_msDS_SupportedEncryptionTypes in the replication meta
data.

BUG: https://bugzilla.samba.org/show_bug.cgi?id=15219
BUG: https://bugzilla.samba.org/show_bug.cgi?id=15237

Signed-off-by: Stefan Metzmacher <metze@samba.org>
Reviewed-by: Joseph Sutton <josephsutton@catalyst.net.nz>
Reviewed-by: Andrew Bartlett <abartlet@samba.org>
(cherry picked from commit f1c5fa28c460f7e011049606b1b9ef96443e5e1f)
---
 librpc/idl/drsuapi.idl | 9 +++++++++
 1 file changed, 9 insertions(+)

diff --git a/librpc/idl/drsuapi.idl b/librpc/idl/drsuapi.idl
index db00eb8639e..59a795a74e3 100644
--- a/librpc/idl/drsuapi.idl
+++ b/librpc/idl/drsuapi.idl
@@ -512,7 +512,11 @@ interface drsuapi
 		DRSUAPI_ATTID_priorValue			= 0x00090064,
 		DRSUAPI_ATTID_supplementalCredentials		= 0x0009007d,
 		DRSUAPI_ATTID_trustAuthIncoming			= 0x00090081,
+		DRSUAPI_ATTID_trustDirection			= 0x00090084,
+		DRSUAPI_ATTID_trustPartner			= 0x00090085,
+		DRSUAPI_ATTID_trustPosixOffset			= 0x00090086,
 		DRSUAPI_ATTID_trustAuthOutgoing			= 0x00090087,
+		DRSUAPI_ATTID_trustType				= 0x00090088,
 		DRSUAPI_ATTID_userParameters			= 0x0009008a,
 		DRSUAPI_ATTID_profilePath			= 0x0009008b,
 		DRSUAPI_ATTID_operatorCount			= 0x00090090,
@@ -532,6 +536,9 @@ interface drsuapi
 		DRSUAPI_ATTID_options				= 0x00090133,
 		DRSUAPI_ATTID_fSMORoleOwner			= 0x00090171,
 		DRSUAPI_ATTID_systemFlags			= 0x00090177,
+		DRSUAPI_ATTID_trustAttributes			= 0x000901d6,
+		DRSUAPI_ATTID_trustParent			= 0x000901d7,
+		DRSUAPI_ATTID_flatName				= 0x000901ff,
 		DRSUAPI_ATTID_serverReference			= 0x00090203,
 		DRSUAPI_ATTID_serverReferenceBL			= 0x00090204,
 		DRSUAPI_ATTID_nonSecurityMember			= 0x00090212,
@@ -550,6 +557,7 @@ interface drsuapi
 		DRSUAPI_ATTID_transportAddressAttribute		= 0x0009037f,
 		DRSUAPI_ATTID_schemaInfo			= 0x0009054e,
 		DRSUAPI_ATTID_msDS_Behavior_Version		= 0x000905b3,
+		DRSUAPI_ATTID_msDS_TrustForestTrustInfo		= 0x000906a6,
 		DRSUAPI_ATTID_msDS_KeyVersionNumber		= 0x000906f6,
 		DRSUAPI_ATTID_msDS_NonMembers			= 0x00090701,
 		DRSUAPI_ATTID_msDS_MembersForAzRole		= 0x0009070e,
@@ -557,6 +565,7 @@ interface drsuapi
 		DRSUAPI_ATTID_msDS_hasMasterNCs			= 0x0009072c,
 		DRSUAPI_ATTID_msDS_NeverRevealGroup		= 0x00090786,
 		DRSUAPI_ATTID_msDS_RevealOnDemandGroup		= 0x00090788,
+		DRSUAPI_ATTID_msDS_SupportedEncryptionTypes	= 0x000907ab,
 		DRSUAPI_ATTID_msDS_HostServiceAccount		= 0x00090808,
 		DRSUAPI_ATTID_isRecycled			= 0x0009080a,
 
-- 
2.34.1

